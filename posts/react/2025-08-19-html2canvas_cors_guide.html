<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/0a38fac37be32038.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-56d9518731895b2c.js"/><script src="/_next/static/chunks/4bd1b696-621d9c5a5ed67c86.js" async=""></script><script src="/_next/static/chunks/1684-2774953d221678f8.js" async=""></script><script src="/_next/static/chunks/main-app-98678e53e0f06a7d.js" async=""></script><script src="/_next/static/chunks/6874-fa507aafc07af06a.js" async=""></script><script src="/_next/static/chunks/9318-102c786377c953a3.js" async=""></script><script src="/_next/static/chunks/app/layout-cc2413b4ac7fd51b.js" async=""></script><script src="/_next/static/chunks/cb15b0f3-4f54b17909709afc.js" async=""></script><script src="/_next/static/chunks/9522-efe1b27bdbdfccd2.js" async=""></script><script src="/_next/static/chunks/app/posts/%5B...slug%5D/page-533962adf6041fb8.js" async=""></script><meta name="next-size-adjust" content=""/><title>Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog</title><meta name="description" content="html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다."/><meta name="author" content="zeke"/><meta name="keywords" content="Next.js, html2canvas, CORS, React, TypeScript, 이미지 프록시"/><meta name="creator" content="zeke"/><meta name="publisher" content="Blog"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta name="google-site-verification" content="wjBK5vsP3u8w2Mb0BHXkojvPGQ56soPTBYg2fU5dg5k"/><meta property="og:title" content="Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog"/><meta property="og:description" content="html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다."/><meta property="og:url" content="https://leeduhan.github.io/posts/react/2025-08-19-html2canvas_cors_guide"/><meta property="og:site_name" content="Blog"/><meta property="og:image" content="https://leeduhan.github.io/og-image.jpg"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image:alt" content="Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2025-08-19"/><meta property="article:author" content="zeke"/><meta property="article:tag" content="Next.js"/><meta property="article:tag" content="html2canvas"/><meta property="article:tag" content="CORS"/><meta property="article:tag" content="React"/><meta property="article:tag" content="TypeScript"/><meta property="article:tag" content="이미지 프록시"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="@zeke"/><meta name="twitter:title" content="Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog"/><meta name="twitter:description" content="html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다."/><meta name="twitter:image" content="https://leeduhan.github.io/og-image.jpg"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_e8ce0c antialiased min-h-screen"><div class="flex min-h-screen flex-col"><header class="sticky top-0 z-50 w-full border-b bg-background/80 backdrop-blur supports-[backdrop-filter]:bg-background/80"><div class="container max-w-4xl mx-auto flex h-16 items-center justify-between px-4"><a class="flex items-center space-x-2 text-xl font-semibold transition-colors hover:text-primary" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text h-6 w-6 text-primary" aria-hidden="true"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path><path d="M10 9H8"></path><path d="M16 13H8"></path><path d="M16 17H8"></path></svg><span>Blog</span></a><div class="flex items-center space-x-6"><nav class="flex items-center space-x-6"><a class="text-sm font-medium text-muted-foreground transition-colors hover:text-foreground" href="/">홈</a><a class="text-sm font-medium text-muted-foreground transition-colors hover:text-foreground" href="/tags">태그</a><a class="text-sm font-medium text-muted-foreground transition-colors hover:text-foreground" href="/about">소개</a></nav><a href="https://github.com/leeduhan" target="_blank" rel="noopener noreferrer" class="text-muted-foreground transition-colors hover:text-foreground" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github h-5 w-5" aria-hidden="true"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button class="h-9 w-9 rounded-lg border border-border hover:bg-accent hover:text-accent-foreground inline-flex items-center justify-center transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" title="테마 변경" type="button" id="radix-«R77b»" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor h-[1.2rem] w-[1.2rem]" aria-hidden="true"><rect width="20" height="14" x="2" y="3" rx="2"></rect><line x1="8" x2="16" y1="21" y2="21"></line><line x1="12" x2="12" y1="17" y2="21"></line></svg><span class="sr-only">테마 변경</span></button></div></div></header><main class="flex-1"><div class="container max-w-4xl mx-auto px-4 py-8"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션","description":"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.","image":["https://leeduhan.github.io/og-image.jpg"],"author":{"@type":"Person","name":"zeke"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject","url":"https://leeduhan.github.io/logo.png"}},"url":"https://leeduhan.github.io/posts/react/2025-08-19-html2canvas_cors_guide","datePublished":"2025-08-19","dateModified":"2025-08-19","keywords":"Next.js, html2canvas, CORS, React, TypeScript, 이미지 프록시","articleSection":"Technology","inLanguage":"ko-KR"}</script><div class="max-w-3xl mx-auto space-y-8"><div class="pt-4"><a class="inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left h-4 w-4" aria-hidden="true"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg><span>홈으로 돌아가기</span></a></div><article class="space-y-8"><header class="space-y-6"><div class="space-y-6"><h1 class="text-5xl font-bold tracking-tight leading-tight">Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션</h1></div><div class="flex flex-wrap items-center gap-6 text-sm text-muted-foreground py-4"><time dateTime="2025-08-19" class="flex items-center gap-2"><span>📅</span>2025년 8월 19일</time><div class="flex flex-wrap items-center gap-2"><span>🏷️</span><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/nextjs">Next.js</a><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/html2canvas">html2canvas</a><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/cors">CORS</a><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/react">React</a><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/typescript">TypeScript</a><a class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors" href="/tags/image-proxy">이미지 프록시</a></div></div><div class="bg-accent/50 rounded-lg p-6 border-l-4 border-primary"><p class="text-lg leading-relaxed italic text-muted-foreground">html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.</p></div></header><div class="notion-content"><h1 id="nextjs-15에서-html2canvas-cors-에러-해결하기-이미지-프록시-솔루션">Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션</h1>
<p>html2canvas를 사용해 화면 캡처 기능을 구현하다 보면 외부 CDN 이미지로 인한 CORS 에러를 자주 만나게 됩니다. 이 글에서는 여러 해결 방법을 비교 분석하고, 실제로 성공한 Next.js API Route 프록시 솔루션을 상세히 공유합니다.</p>
<h2 id="-목차">📋 목차</h2>
<ol>
<li><a href="#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9%EA%B3%BC-%EC%9B%90%EC%9D%B8">문제 상황과 원인</a></li>
<li><a href="#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95-%EB%B9%84%EA%B5%90">해결 방법 비교</a></li>
<li><a href="#%EC%8B%A4%EC%A0%9C-%EC%84%B1%EA%B3%B5%ED%95%9C-%ED%95%B4%EA%B2%B0%EC%B1%85-nextjs-%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%94%84%EB%A1%9D%EC%8B%9C">실제 성공한 해결책: Next.js 이미지 프록시</a></li>
<li><a href="#%EB%8C%80%EC%95%88-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95%EB%93%A4">대안 해결 방법들</a></li>
<li><a href="#%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%B0%8F-%EC%B6%94%EA%B0%80-%ED%8C%81">성능 최적화 및 추가 팁</a></li>
</ol>
<h2 id="문제-상황과-원인">문제 상황과 원인</h2>
<p>웹 애플리케이션에서 html2canvas를 사용해 화면을 캡처하려고 했는데 다음과 같은 CORS 에러가 발생했습니다:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">code-highlight</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words code-highlight"><code class="code-highlight"><span class="code-line line-number" line="1">Access to image at &#x27;https://cdn.example.com/images/my-image.svg&#x27; 
</span><span class="code-line line-number" line="2">from origin &#x27;http://localhost:3001&#x27; has been blocked by CORS policy: 
</span><span class="code-line line-number" line="3">No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource.
</span></code></pre></div></div>
<h3 id="근본-원인">근본 원인</h3>
<ul>
<li><strong>html2canvas의 작동 방식</strong>: DOM을 Canvas로 그리는 과정에서 Canvas API를 사용</li>
<li><strong>Same-Origin Policy</strong>: 브라우저의 보안 정책으로 인한 크로스 도메인 이미지 접근 제한</li>
<li><strong>외부 CDN 이미지</strong>: CORS 헤더를 제공하지 않는 외부 도메인 이미지</li>
<li><strong>브라우저 캐싱</strong>: 첫 번째 요청 시 CORS 헤더가 없으면 캐시된 이미지도 동일한 문제 발생</li>
</ul>
<h2 id="해결-방법-비교">해결 방법 비교</h2>
<p>여러 해결 방법을 시도해본 결과, 각각의 장단점을 정리하면 다음과 같습니다:</p>
<table><thead><tr><th>순위</th><th>방법</th><th>난이도</th><th>효과</th><th>적용 범위</th><th>권장도</th></tr></thead><tbody><tr><td>🏆</td><td><strong>Next.js API Route 프록시</strong></td><td>⭐⭐</td><td>⭐⭐⭐⭐⭐</td><td>프로덕션</td><td>✅ <strong>최고</strong></td></tr><tr><td>🥈</td><td>Next.js Image + 커스텀 로더</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐⭐</td><td>고급</td><td>✅ 권장</td></tr><tr><td>🥉</td><td>next.config.js Rewrites</td><td>⭐</td><td>⭐⭐⭐⭐</td><td>간편</td><td>⚠️ 제한적</td></tr><tr><td>4</td><td>클라이언트 최적화</td><td>⭐</td><td>⭐⭐⭐</td><td>즉시</td><td>⚠️ 임시방편</td></tr><tr><td>5</td><td>Middleware CORS</td><td>⭐⭐⭐</td><td>⭐⭐⭐</td><td>전역</td><td>❌ 복잡함</td></tr></tbody></table>
<h3 id="1-클라이언트-최적화-즉시-적용-가능-️">1. 클라이언트 최적화 (즉시 적용 가능) ⚠️</h3>
<p>가장 빠르게 적용할 수 있는 임시 해결책입니다:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">import</span> html2canvas <span class="token keyword">from</span> <span class="token string">&#x27;html2canvas&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> <span class="token function-variable function">captureElement</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token comment">// 이미지들을 캐시 무효화로 미리 로드</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> images <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#x27;img&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="7">    <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>img <span class="token operator">=&gt;</span> 
</span><span class="code-line line-number" line="8">      <span class="token function">fetch</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>src <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?t=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
</span><span class="code-line line-number" line="9">        cache<span class="token operator">:</span> <span class="token string">&#x27;no-cache&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="10">        mode<span class="token operator">:</span> <span class="token string">&#x27;cors&#x27;</span> 
</span><span class="code-line line-number" line="11">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="12">    <span class="token punctuation">)</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">
</span><span class="code-line line-number" line="15">  <span class="token comment">// html2canvas 실행</span>
</span><span class="code-line line-number" line="16">  <span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>elementRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="17">    useCORS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="18">    allowTaint<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="19">    scale<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="20">    logging<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="21">    foreignObjectRendering<span class="token operator">:</span> <span class="token boolean">true</span>
</span><span class="code-line line-number" line="22">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="23">
</span><span class="code-line line-number" line="24">  <span class="token keyword">return</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#x27;image/png&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="25"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<p><strong>장점</strong>: 즉시 적용 가능, 별도 서버 설정 불필요<br/>
<strong>단점</strong>: 브라우저 캐싱 문제로 불안정, 근본적 해결책 아님</p>
<h3 id="2-nextconfigjs-rewrites-간단한-프록시-️">2. next.config.js Rewrites (간단한 프록시) ⚠️</h3>
<p>설정만으로 간단히 해결하는 방법:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">javascript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-javascript code-highlight"><code class="language-javascript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// next.config.js</span>
</span><span class="code-line line-number" line="2"><span class="token doc-comment comment">/** <span class="token keyword">@type</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#x27;next&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>NextConfig<span class="token punctuation">}</span></span> */</span>
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> nextConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">async</span> <span class="token function">rewrites</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">    <span class="token keyword control-flow">return</span> <span class="token punctuation">[</span>
</span><span class="code-line line-number" line="6">      <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">        <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#x27;/api/images/:path*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">        <span class="token literal-property property">destination</span><span class="token operator">:</span> <span class="token string">&#x27;https://external-domain.com/:path*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="9">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="10">    <span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="12">  <span class="token literal-property property">images</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    <span class="token literal-property property">remotePatterns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="code-line line-number" line="14">      <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="15">        <span class="token literal-property property">protocol</span><span class="token operator">:</span> <span class="token string">&#x27;https&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="16">        <span class="token literal-property property">hostname</span><span class="token operator">:</span> <span class="token string">&#x27;**&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="17">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="18">    <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="19">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="20"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="21">
</span><span class="code-line line-number" line="22">module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> nextConfig<span class="token punctuation">;</span>
</span></code></pre></div></div>
<p><strong>장점</strong>: 설정만으로 해결, Next.js 내장 기능 활용<br/>
<strong>단점</strong>: 특정 도메인에만 제한적, 동적 URL 처리 어려움</p>
<h3 id="3-nextjs-image--커스텀-로더-권장-">3. Next.js Image + 커스텀 로더 (권장) ✅</h3>
<p>Next.js Image 컴포넌트의 강력한 기능을 활용:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// components/ProxyImage.tsx</span>
</span><span class="code-line line-number" line="2"><span class="token string">&#x27;use client&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">import</span> Image <span class="token keyword">from</span> <span class="token string">&#x27;next/image&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token keyword">const</span> <span class="token function-variable function">customLoader</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> src<span class="token punctuation">,</span> width<span class="token punctuation">,</span> quality <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">  src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">  quality<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">  <span class="token comment">// 외부 도메인 이미지는 프록시를 통해 로드</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">if</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&#x27;http&#x27;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/proxy-image?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;w=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quality <span class="token operator">||</span> <span class="token number">75</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="15">  <span class="token keyword">return</span> src<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="16"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="17">
</span><span class="code-line line-number" line="18"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">ProxyImage</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="19">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="20">    <span class="token operator">&lt;</span>Image
</span><span class="code-line line-number" line="21">      loader<span class="token operator">=</span><span class="token punctuation">{</span>customLoader<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="22">      crossOrigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
</span><span class="code-line line-number" line="23">      <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="24">    <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line line-number" line="25">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="26"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<p><strong>장점</strong>: 자동 최적화, WebP 변환, 레이지 로딩, 반응형 지원<br/>
<strong>단점</strong>: Next.js Image API 학습 필요, 약간 복잡함</p>
<h2 id="실제-성공한-해결책-nextjs-이미지-프록시">실제 성공한 해결책: Next.js 이미지 프록시</h2>
<p>여러 해결 방법을 시도한 결과, <strong>Next.js API Route를 활용한 이미지 프록시</strong> 방식이 가장 안정적이고 효과적인 솔루션이었습니다. 이 방법으로 프로덕션 환경에서 완전히 문제를 해결할 수 있었습니다.</p>
<h3 id="핵심-아이디어">핵심 아이디어</h3>
<p>외부 CDN 이미지를 직접 사용하지 않고, Next.js 서버를 경유해서 이미지를 프록시하여 CORS 헤더를 추가하는 방식입니다:</p>
<div class="my-8 flex justify-center"><div id="mermaid-jf7ww44ov" class="mermaid-diagram w-full"></div></div>
<h3 id="1단계-api-route-프록시-엔드포인트-생성">1단계: API Route 프록시 엔드포인트 생성</h3>
<p>가장 핵심이 되는 서버사이드 프록시 엔드포인트를 구현합니다:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// app/api/image-proxy/route.ts</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">import</span> <span class="token punctuation">{</span> NextRequest<span class="token punctuation">,</span> NextResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;next/server&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span>request<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token punctuation">{</span> searchParams <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">const</span> imageUrl <span class="token operator">=</span> searchParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;url&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imageUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">&#x27;URL parameter is required&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">400</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    <span class="token comment">// 외부 이미지 URL 유효성 검사</span>
</span><span class="code-line line-number" line="14">    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="15">    
</span><span class="code-line line-number" line="16">    <span class="token comment">// 허용된 도메인만 프록시 (보안상 중요)</span>
</span><span class="code-line line-number" line="17">    <span class="token keyword">const</span> allowedDomains <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line line-number" line="18">      <span class="token string">&#x27;cdn.example.com&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="19">      <span class="token string">&#x27;assets.mysite.com&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="20">      <span class="token string">&#x27;images.service.com&#x27;</span>
</span><span class="code-line line-number" line="21">    <span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22">    
</span><span class="code-line line-number" line="23">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>allowedDomains<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="24">      <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">&#x27;Domain not allowed&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">403</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="25">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="26">
</span><span class="code-line line-number" line="27">    <span class="token comment">// 외부 이미지 fetch</span>
</span><span class="code-line line-number" line="28">    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="29">      headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="30">        <span class="token string-property property">&#x27;User-Agent&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;Mozilla/5.0 (compatible; NextJS Image Proxy)&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="31">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="32">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="33">
</span><span class="code-line line-number" line="34">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="35">      <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="36">        <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Failed to fetch image: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="37">        <span class="token punctuation">{</span> status<span class="token operator">:</span> response<span class="token punctuation">.</span>status <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="38">      <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="39">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="40">
</span><span class="code-line line-number" line="41">    <span class="token keyword">const</span> imageBuffer <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="42">    <span class="token keyword">const</span> contentType <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;content-type&#x27;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&#x27;image/jpeg&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="43">
</span><span class="code-line line-number" line="44">    <span class="token comment">// 🔑 핵심: CORS 헤더와 함께 이미지 반환</span>
</span><span class="code-line line-number" line="45">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span>imageBuffer<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="46">      headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="47">        <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="48">        <span class="token string-property property">&#x27;Cache-Control&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;public, max-age=31536000, immutable&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="49">        <span class="token string-property property">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="50">        <span class="token string-property property">&#x27;Access-Control-Allow-Methods&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;GET&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="51">        <span class="token string-property property">&#x27;Access-Control-Allow-Headers&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;Content-Type&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="52">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="53">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="54">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="55">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#x27;Image proxy error:&#x27;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="56">    <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">&#x27;Failed to proxy image&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">500</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="57">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="58"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<h3 id="2단계-proxyimage-컴포넌트-구현">2단계: ProxyImage 컴포넌트 구현</h3>
<p>외부 이미지를 자동으로 프록시를 통해 로드하는 컴포넌트를 만듭니다:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// components/ProxyImage.tsx</span>
</span><span class="code-line line-number" line="2"><span class="token string">&#x27;use client&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4"><span class="token keyword">import</span> Image<span class="token punctuation">,</span> <span class="token punctuation">{</span> ImageLoader<span class="token punctuation">,</span> ImageProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;next/image&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment">// 외부 도메인 이미지인지 확인 (SSR 안전)</span>
</span><span class="code-line line-number" line="8"><span class="token keyword">const</span> isExternalImage <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">    <span class="token keyword">return</span> url<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&#x27;http:&#x27;</span> <span class="token operator">||</span> url<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&#x27;https:&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="15"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="16">
</span><span class="code-line line-number" line="17"><span class="token comment">// 🔑 핵심: CORS 문제 해결을 위한 커스텀 로더</span>
</span><span class="code-line line-number" line="18"><span class="token keyword">const</span> corsProxyLoader<span class="token operator">:</span> <span class="token function-variable function">ImageLoader</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> src<span class="token punctuation">,</span> width<span class="token punctuation">,</span> quality <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="19">  <span class="token comment">// 외부 도메인 이미지면 프록시를 통해 로드</span>
</span><span class="code-line line-number" line="20">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isExternalImage</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="21">    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/image-proxy?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;w=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;q=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>quality <span class="token operator">||</span> <span class="token number">75</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="23">  <span class="token keyword">return</span> src<span class="token punctuation">;</span> <span class="token comment">// 내부 이미지는 그대로 사용</span>
</span><span class="code-line line-number" line="24"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="25">
</span><span class="code-line line-number" line="26"><span class="token keyword">interface</span> <span class="token class-name">ProxyImageProps</span> <span class="token keyword">extends</span> <span class="token class-name">Omit<span class="token operator">&lt;</span>ImageProps<span class="token punctuation">,</span> <span class="token string">&#x27;loader&#x27;</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="27">  fallbackSrc<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="28"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="29">
</span><span class="code-line line-number" line="30"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">ProxyImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> fallbackSrc<span class="token punctuation">,</span> onError<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token operator">:</span> ProxyImageProps<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="31">  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="32">
</span><span class="code-line line-number" line="33">  <span class="token keyword">const</span> <span class="token function-variable function">handleError</span> <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> React<span class="token punctuation">.</span>SyntheticEvent<span class="token operator">&lt;</span>HTMLImageElement<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="34">    <span class="token function">setError</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="35">    onError<span class="token operator">?.</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="36">  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="37">
</span><span class="code-line line-number" line="38">  <span class="token comment">// 에러 시 fallback 이미지 표시</span>
</span><span class="code-line line-number" line="39">  <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> fallbackSrc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="40">    <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="41">      <span class="token operator">&lt;</span>Image
</span><span class="code-line line-number" line="42">        <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="43">        src<span class="token operator">=</span><span class="token punctuation">{</span>fallbackSrc<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="44">        loader<span class="token operator">=</span><span class="token punctuation">{</span>corsProxyLoader<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="45">        crossOrigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
</span><span class="code-line line-number" line="46">        onError<span class="token operator">=</span><span class="token punctuation">{</span>handleError<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="47">      <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line line-number" line="48">    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="49">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="50">
</span><span class="code-line line-number" line="51">  <span class="token keyword">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="52">    <span class="token operator">&lt;</span>Image
</span><span class="code-line line-number" line="53">      <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="54">      loader<span class="token operator">=</span><span class="token punctuation">{</span>corsProxyLoader<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="55">      crossOrigin<span class="token operator">=</span><span class="token string">&quot;anonymous&quot;</span>
</span><span class="code-line line-number" line="56">      onError<span class="token operator">=</span><span class="token punctuation">{</span>handleError<span class="token punctuation">}</span>
</span><span class="code-line line-number" line="57">    <span class="token operator">/</span><span class="token operator">&gt;</span>
</span><span class="code-line line-number" line="58">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="59"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h3 id="3단계-컴포넌트-교체">3단계: 컴포넌트 교체</h3>
<p>이제 기존 이미지 컴포넌트를 ProxyImage로 교체하기만 하면 됩니다.</p>
<p><strong>교체 과정</strong>:</p>
<ol>
<li>기존 <code>&lt;Image&gt;</code> 또는 <code>&lt;img&gt;</code> 태그를 <code>&lt;ProxyImage&gt;</code>로 변경</li>
<li>외부 CDN URL을 사용하는 이미지들을 우선적으로 교체</li>
<li>필요에 따라 <code>fallbackSrc</code> prop으로 대체 이미지 지정</li>
<li>기존 props(<code>width</code>, <code>height</code>, <code>className</code> 등)은 그대로 유지 가능</li>
</ol>
<p><strong>핵심 포인트</strong>: ProxyImage는 Next.js Image와 동일한 API를 제공하므로, 기존 코드의 변경 없이도 CORS 문제를 해결할 수 있습니다.</p>
<h3 id="4단계-html2canvas와-함께-사용">4단계: html2canvas와 함께 사용</h3>
<p>html2canvas로 캡처할 때 ProxyImage가 포함된 컴포넌트를 캡처하면 CORS 문제 없이 정상 작동합니다:</p>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">import</span> html2canvas <span class="token keyword">from</span> <span class="token string">&#x27;html2canvas&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> <span class="token function-variable function">handleCapture</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#x27;[data-capture-target]&#x27;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  
</span><span class="code-line line-number" line="6">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    <span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">      useCORS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="11">      allowTaint<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="12">      scale<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="13">      backgroundColor<span class="token operator">:</span> <span class="token string">&#x27;#ffffff&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="14">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16">    <span class="token comment">// 이미지 다운로드</span>
</span><span class="code-line line-number" line="17">    <span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18">    link<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">capture-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.png</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="19">    link<span class="token punctuation">.</span>href <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">&#x27;image/png&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="20">    link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="21">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="22">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#x27;캡처 실패:&#x27;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="23">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="24"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h2 id="핵심-구현-포인트">핵심 구현 포인트</h2>
<h3 id="1-보안-고려사항">1. 보안 고려사항</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// 허용된 도메인만 프록시</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> allowedDomains <span class="token operator">=</span> <span class="token punctuation">[</span>
</span><span class="code-line line-number" line="3">  <span class="token string">&#x27;cdn.example.com&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  <span class="token string">&#x27;assets.mysite.com&#x27;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>allowedDomains<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>hostname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="8">  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token string">&#x27;Domain not allowed&#x27;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> status<span class="token operator">:</span> <span class="token number">403</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<p>허용된 도메인만 프록시하여 보안 위험을 방지합니다.</p>
<h3 id="2-ssr-호환성">2. SSR 호환성</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> isExternalImage <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">try</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">    <span class="token comment">// window.location이 아닌 프로토콜로 판단하여 SSR 안전성 확보</span>
</span><span class="code-line line-number" line="5">    <span class="token keyword">return</span> url<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&#x27;http:&#x27;</span> <span class="token operator">||</span> url<span class="token punctuation">.</span>protocol <span class="token operator">===</span> <span class="token string">&#x27;https:&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="9"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<p>서버사이드 렌더링에서도 안전하게 작동하도록 <code>window</code> 객체 의존성을 제거했습니다.</p>
<h3 id="3-캐시-최적화">3. 캐시 최적화</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1">headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  <span class="token string-property property">&#x27;Cache-Control&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;public, max-age=31536000, immutable&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  <span class="token string-property property">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">  <span class="token string-property property">&#x27;Access-Control-Allow-Methods&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;GET&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">  <span class="token string-property property">&#x27;Access-Control-Allow-Headers&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;Content-Type&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<p>이미지를 1년간 캐시하여 성능을 최적화합니다.</p>
<h2 id="트러블슈팅">트러블슈팅</h2>
<h3 id="1-hydration-mismatch-에러">1. Hydration Mismatch 에러</h3>
<p><strong>문제</strong>: 서버와 클라이언트에서 다른 URL 생성으로 인한 Hydration 에러<br/>
<strong>해결</strong>: <code>window.location.origin</code> 대신 프로토콜 기반으로 외부 이미지 판단</p>
<h3 id="2-무한-로딩">2. 무한 로딩</h3>
<p><strong>문제</strong>: 프록시 로더가 적용되지 않아 원본 URL로 요청<br/>
<strong>해결</strong>: SSR 안전한 로직으로 변경하여 서버/클라이언트 일관성 확보</p>
<h2 id="대안-해결-방법들">대안 해결 방법들</h2>
<h3 id="1-캐싱이-포함된-개선된-api-route">1. 캐싱이 포함된 개선된 API Route</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// 메모리 캐시 추가</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> imageCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span></span><span class="code-line line-number" line="3"><span class="token class-name">  data<span class="token operator">:</span> ArrayBuffer<span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="4"><span class="token class-name">  contentType<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="5"><span class="token class-name">  timestamp<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="6"><span class="token class-name"><span class="token punctuation">}</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token keyword">const</span> <span class="token constant">CACHE_DURATION</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 10분 캐시</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span>request<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">  <span class="token comment">// 캐시 확인 로직 추가</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">const</span> cached <span class="token operator">=</span> imageCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">&amp;&amp;</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cached<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> <span class="token constant">CACHE_DURATION</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="14">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span>cached<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="15">      headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="16">        <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> cached<span class="token punctuation">.</span>contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="17">        <span class="token string-property property">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="18">        <span class="token string-property property">&#x27;Cache-Control&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;public, max-age=300&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="19">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="20">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="21">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="22">  
</span><span class="code-line line-number" line="23">  <span class="token comment">// fetch 후 캐시에 저장</span>
</span><span class="code-line line-number" line="24">  imageCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="25">    data<span class="token operator">:</span> imageBuffer<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="26">    contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="27">    timestamp<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="28">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="29"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<h3 id="2-대안-라이브러리-고려">2. 대안 라이브러리 고려</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">bash</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-bash code-highlight"><code class="language-bash code-highlight"><span class="code-line line-number" line="1"><span class="token function">npm</span> <span class="token function">install</span> modern-screenshot
</span></code></pre></div></div>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">import</span> <span class="token punctuation">{</span> domToJpeg <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#x27;modern-screenshot&#x27;</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> dataUrl <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">domToJpeg</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h2 id="성능-최적화-및-추가-팁">성능 최적화 및 추가 팁</h2>
<h3 id="1-html2canvas-최적화-설정">1. html2canvas 최적화 설정</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  useCORS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  allowTaint<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  scale<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">  logging<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">  backgroundColor<span class="token operator">:</span> <span class="token string">&#x27;#ffffff&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  foreignObjectRendering<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">  imageTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="9">  <span class="token function-variable function">onclone</span><span class="token operator">:</span> <span class="token punctuation">(</span>clonedDoc<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;문서 클론 완료&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="12"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h3 id="2-이미지-프리로딩">2. 이미지 프리로딩</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// 캡처 전 이미지 프리로딩</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> <span class="token function-variable function">preloadImages</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>urls<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">  <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="4">    urls<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>url <span class="token operator">=&gt;</span> 
</span><span class="code-line line-number" line="5">      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/image-proxy?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
</span><span class="code-line line-number" line="6">        cache<span class="token operator">:</span> <span class="token string">&#x27;no-cache&#x27;</span> 
</span><span class="code-line line-number" line="7">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">    <span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h2 id="결과">결과</h2>
<p>✅ <strong>CORS 에러 해결</strong>: 외부 CDN 이미지를 프록시를 통해 안전하게 로드<br/>
<!-- -->✅ <strong>html2canvas 호환</strong>: 캡처 기능이 정상적으로 작동<br/>
<!-- -->✅ <strong>성능 최적화</strong>: 이미지 캐싱 및 반응형 최적화<br/>
<!-- -->✅ <strong>보안 강화</strong>: 허용된 도메인만 프록시하여 보안 위험 방지<br/>
<!-- -->✅ <strong>개발자 경험</strong>: 기존 Image 컴포넌트와 동일한 API로 쉬운 사용</p>
<h2 id="마무리">마무리</h2>
<p>Next.js의 API Route를 활용한 이미지 프록시 솔루션으로 CORS 문제를 깔끔하게 해결할 수 있었습니다. 특히 SSR 호환성과 보안을 고려한 설계로 프로덕션 환경에서도 안전하게 사용할 수 있는 솔루션이 되었습니다.</p>
<h3 id="권장-구현-순서">권장 구현 순서</h3>
<ol>
<li><strong>1단계</strong>: API Route 프록시 엔드포인트 생성 (10분)</li>
<li><strong>2단계</strong>: ProxyImage 컴포넌트 구현 (20분)</li>
<li><strong>3단계</strong>: 기존 이미지 컴포넌트 교체 (5분)</li>
<li><strong>4단계</strong>: html2canvas 테스트 및 최적화 (15분)</li>
<li><strong>5단계</strong>: 성능 최적화 및 캐싱 추가 (선택사항)</li>
</ol>
<p>이 순서대로 진행하면 <strong>Next.js 15의 강력한 서버사이드 기능을 활용</strong>하여 html2canvas CORS 문제를 <strong>가장 효율적으로 해결</strong>할 수 있습니다!</p>
<h3 id="핵심-성과">핵심 성과</h3>
<ul>
<li><strong>html2canvas 호환성</strong>: 외부 CDN 이미지가 포함된 화면을 성공적으로 캡처</li>
<li><strong>성능 최적화</strong>: 이미지 캐싱과 반응형 최적화로 사용자 경험 향상</li>
<li><strong>보안 강화</strong>: 도메인 화이트리스트로 악의적 요청 차단</li>
<li><strong>개발자 경험</strong>: 기존 Image 컴포넌트와 동일한 API로 쉬운 마이그레이션</li>
</ul>
<p>이 방법은 html2canvas뿐만 아니라 Canvas API를 사용하는 다른 라이브러리(Fabric.js, Konva.js 등)에서도 동일하게 적용할 수 있어, 크로스 도메인 이미지 처리가 필요한 다양한 상황에서 유용할 것입니다.</p>
<hr/>
<h2 id="️-api-route-프록시-방식-주의사항">⚠️ API Route 프록시 방식 주의사항</h2>
<p>API Route 프록시는 html2canvas CORS 문제를 해결하지만, <strong>서버 리소스</strong> 측면에서 고려해야 할 사항이 있습니다:</p>
<h3 id="️-서버-리소스-문제">🖼️ 서버 리소스 문제</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">html</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-html code-highlight"><code class="language-html code-highlight"><span class="code-line line-number" line="1"><span class="token comment">&lt;!-- Next.js Image가 생성하는 HTML --&gt;</span>
</span><span class="code-line line-number" line="2"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/api/image-proxy?url=...&amp;w=256 256w,
</span></span></span><span class="code-line line-number" line="3"><span class="token tag"><span class="token attr-value">             /api/image-proxy?url=...&amp;w=384 384w,
</span></span></span><span class="code-line line-number" line="4"><span class="token tag"><span class="token attr-value">             /api/image-proxy?url=...&amp;w=640 640w<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</span></code></pre></div></div>
<p><strong>문제점</strong>:</p>
<ul>
<li>모든 이미지 요청이 서버를 거쳐감 → <strong>서버 부하 증가</strong></li>
<li>여러 크기의 이미지가 서버 캐시에 저장 → <strong>메모리 사용량 증가</strong></li>
<li>Vercel/Netlify 등에서 <strong>Function timeout</strong> 발생 가능</li>
</ul>
<h3 id="-해결-방법">💡 해결 방법</h3>
<h4 id="1-적극적인-캐시-정책">1. 적극적인 캐시 정책</h4>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span>imageBuffer<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token string-property property">&#x27;Cache-Control&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;public, max-age=31536000, immutable&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">    <span class="token string-property property">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h4 id="2-cdn-활용">2. CDN 활용</h4>
<ul>
<li>CloudFlare, AWS CloudFront로 서버 부하 분산</li>
<li>이미지 크기 제한 (최대 5MB)</li>
<li>화이트리스트 도메인 관리</li>
</ul>
<blockquote>
<p><strong>📝 Next.js Image 컴포넌트 기술적 제한사항</strong>: <code>unoptimized</code>와 <code>loader</code> 충돌 문제, SVG 처리 방법 등은 <a href="./2025-08-19-nextjs-15-image-optimization-guide">다음 글</a>에서 상세히 다룹니다.</p>
</blockquote>
<h2 id="-성능-최적화-및-추가-팁">🚀 성능 최적화 및 추가 팁</h2>
<h3 id="1-html2canvas-최적화-설정-1">1. html2canvas 최적화 설정</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> canvas <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  useCORS<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="3">  allowTaint<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="4">  scale<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="5">  logging<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="6">  backgroundColor<span class="token operator">:</span> <span class="token string">&#x27;#ffffff&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="7">  foreignObjectRendering<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="8">  imageTimeout<span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="9">  <span class="token function-variable function">onclone</span><span class="token operator">:</span> <span class="token punctuation">(</span>clonedDoc<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="10">    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;문서 클론 완료&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="12"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h3 id="2-이미지-프리로딩-1">2. 이미지 프리로딩</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// 캡처 전 이미지 프리로딩</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> <span class="token function-variable function">preloadImages</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>urls<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">  <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
</span><span class="code-line line-number" line="4">    urls<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>url <span class="token operator">=&gt;</span> 
</span><span class="code-line line-number" line="5">      <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/api/image-proxy?url=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> 
</span><span class="code-line line-number" line="6">        cache<span class="token operator">:</span> <span class="token string">&#x27;no-cache&#x27;</span> 
</span><span class="code-line line-number" line="7">      <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">    <span class="token punctuation">)</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre></div></div>
<h3 id="3-메모리-캐시-추가-고급">3. 메모리 캐시 추가 (고급)</h3>
<div class="code-block-wrapper my-6"><div class="relative group"><div class="flex items-center justify-between bg-muted border border-b-0 rounded-t-lg px-4 py-2"><span class="text-xs font-medium text-muted-foreground uppercase tracking-wide">typescript</span><button class="flex items-center gap-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-muted-foreground" title="코드 복사"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy h-3 w-3" aria-hidden="true"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>복사</span></button></div><pre class="overflow-x-auto rounded-t-none rounded-b-lg bg-muted border p-4 text-sm whitespace-pre-wrap break-words language-typescript code-highlight"><code class="language-typescript code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// 메모리 캐시 추가</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> imageCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span></span><span class="code-line line-number" line="3"><span class="token class-name">  data<span class="token operator">:</span> ArrayBuffer<span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="4"><span class="token class-name">  contentType<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="5"><span class="token class-name">  timestamp<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
</span></span><span class="code-line line-number" line="6"><span class="token class-name"><span class="token punctuation">}</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8"><span class="token keyword">const</span> <span class="token constant">CACHE_DURATION</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 10분 캐시</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span>request<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">  <span class="token comment">// 캐시 확인 로직 추가</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">const</span> cached <span class="token operator">=</span> imageCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">&amp;&amp;</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> cached<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> <span class="token constant">CACHE_DURATION</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="14">    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">NextResponse</span><span class="token punctuation">(</span>cached<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="15">      headers<span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="16">        <span class="token string-property property">&#x27;Content-Type&#x27;</span><span class="token operator">:</span> cached<span class="token punctuation">.</span>contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="17">        <span class="token string-property property">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;*&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="18">        <span class="token string-property property">&#x27;Cache-Control&#x27;</span><span class="token operator">:</span> <span class="token string">&#x27;public, max-age=300&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="19">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="20">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="21">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="22">  
</span><span class="code-line line-number" line="23">  <span class="token comment">// fetch 후 캐시에 저장</span>
</span><span class="code-line line-number" line="24">  imageCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>imageUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="25">    data<span class="token operator">:</span> imageBuffer<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="26">    contentType<span class="token punctuation">,</span>
</span><span class="code-line line-number" line="27">    timestamp<span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line line-number" line="28">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="29"><span class="token punctuation">}</span>
</span></code></pre></div></div>
<h3 id="-더-자세한-이미지-최적화-가이드">📚 더 자세한 이미지 최적화 가이드</h3>
<p>Next.js 15의 공식 권장사항과 더 자세한 성능 비교를 원한다면 **<a href="/posts/react/2025-08-19-nextjs-15-image-optimization-guide">Next.js 15 이미지 최적화 완전 가이드</a>**를 참고하세요.</p></div></article></div><!--$--><!--/$--><!--$--><!--/$--></div></main><footer class="border-t py-8 md:py-12"><div class="container max-w-4xl mx-auto px-4"><div class="flex flex-col items-center justify-center space-y-4 text-center"><div class="flex items-center space-x-4 text-sm"><a href="/rss.xml" class="text-muted-foreground hover:text-primary transition-colors" target="_blank" rel="noopener noreferrer">RSS</a><span class="text-muted-foreground">•</span><a href="/feed.json" class="text-muted-foreground hover:text-primary transition-colors" target="_blank" rel="noopener noreferrer">JSON Feed</a></div><p class="text-sm text-muted-foreground">© 2025.06 ~ <!-- -->2025<!-- -->.<!-- -->8<!-- --> Blog</p></div></div></footer></div><script src="/_next/static/chunks/webpack-56d9518731895b2c.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[61483,[\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9318\",\"static/chunks/9318-102c786377c953a3.js\",\"7177\",\"static/chunks/app/layout-cc2413b4ac7fd51b.js\"],\"ThemeProvider\"]\n3:I[12708,[\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9318\",\"static/chunks/9318-102c786377c953a3.js\",\"7177\",\"static/chunks/app/layout-cc2413b4ac7fd51b.js\"],\"Analytics\"]\n4:I[12708,[\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9318\",\"static/chunks/9318-102c786377c953a3.js\",\"7177\",\"static/chunks/app/layout-cc2413b4ac7fd51b.js\"],\"GoogleAds\"]\n5:I[6874,[\"6249\",\"static/chunks/cb15b0f3-4f54b17909709afc.js\",\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9522\",\"static/chunks/9522-efe1b27bdbdfccd2.js\",\"6156\",\"static/chunks/app/posts/%5B...slug%5D/page-533962adf6041fb8.js\"],\"\"]\n6:I[66688,[\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9318\",\"static/chunks/9318-102c786377c953a3.js\",\"7177\",\"static/chunks/app/layout-cc2413b4ac7fd51b.js\"],\"ThemeToggle\"]\n7:I[87555,[],\"\"]\n8:I[31295,[],\"\"]\na:I[59665,[],\"MetadataBoundary\"]\nc:I[59665,[],\"OutletBoundary\"]\nf:I[74911,[],\"AsyncMetadataOutlet\"]\n11:I[59665,[],\"ViewportBoundary\"]\n13:I[26614,[],\"\"]\n:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/0a38fac37be32038.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"biUM6TXr8YHgyoF-Rc1T-\",\"p\":\"\",\"c\":[\"\",\"posts\",\"react\",\"2025-08-19-html2canvas_cors_guide\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"react/2025-08-19-html2canvas_cors_guide\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0a38fac37be32038.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_e8ce0c antialiased min-h-screen\",\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"div\",null,{\"className\":\"flex min-h-screen flex-col\",\"children\":[[\"$\",\"$L3\",null,{}],[\"$\",\"$L4\",null,{}],[\"$\",\"header\",null,{\"className\":\"sticky top-0 z-50 w-full border-b bg-background/80 backdrop-blur supports-[backdrop-filter]:bg-background/80\",\"children\":[\"$\",\"div\",null,{\"className\":\"container max-w-4xl mx-auto flex h-16 items-center justify-between px-4\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"flex items-center space-x-2 text-xl font-semibold transition-colors hover:text-primary\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-file-text h-6 w-6 text-primary\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1rqfz7\",{\"d\":\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\"}],[\"$\",\"path\",\"tnqrlb\",{\"d\":\"M14 2v4a2 2 0 0 0 2 2h4\"}],[\"$\",\"path\",\"b1mrlr\",{\"d\":\"M10 9H8\"}],[\"$\",\"path\",\"t4e002\",{\"d\":\"M16 13H8\"}],[\"$\",\"path\",\"z1uh3a\",{\"d\":\"M16 17H8\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":\"Blog\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-6\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"flex items-center space-x-6\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"text-sm font-medium text-muted-foreground transition-colors hover:text-foreground\",\"children\":\"홈\"}],[\"$\",\"$L5\",null,{\"href\":\"/tags\",\"className\":\"text-sm font-medium text-muted-foreground transition-colors hover:text-foreground\",\"children\":\"태그\"}],[\"$\",\"$L5\",null,{\"href\":\"/about\",\"className\":\"text-sm font-medium text-muted-foreground transition-colors hover:text-foreground\",\"children\":\"소개\"}]]}],[\"$\",\"a\",null,{\"href\":\"https://github.com/leeduhan\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-muted-foreground transition-colors hover:text-foreground\",\"aria-label\":\"GitHub\",\"children\":[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-github h-5 w-5\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"tonef\",{\"d\":\"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4\"}],[\"$\",\"path\",\"9comsn\",{\"d\":\"M9 18c-4.51 2-5-2-7-2\"}],\"$undefined\"]}]}],[\"$\",\"$L6\",null,{}]]}]]}]}],[\"$\",\"main\",null,{\"className\":\"flex-1\",\"children\":[\"$\",\"div\",null,{\"className\":\"container max-w-4xl mx-auto px-4 py-8\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}],[\"$\",\"footer\",null,{\"className\":\"border-t py-8 md:py-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"container max-w-4xl mx-auto px-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center space-y-4 text-center\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center space-x-4 text-sm\",\"children\":[[\"$\",\"a\",null,{\"href\":\"/rss.xml\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":\"RSS\"}],[\"$\",\"span\",null,{\"className\":\"text-muted-foreground\",\"children\":\"•\"}],[\"$\",\"a\",null,{\"href\":\"/feed.json\",\"className\":\"text-muted-foreground hover:text-primary transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":\"JSON Feed\"}]]}],[\"$\",\"p\",null,{\"className\":\"text-sm text-muted-foreground\",\"children\":[\"© 2025.06 ~ \",2025,\".\",8,\" Blog\"]}]]}]}]}]]}]}]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"react/2025-08-19-html2canvas_cors_guide\",\"c\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L9\",[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],null,[\"$\",\"$Lc\",null,{\"children\":[\"$Ld\",\"$Le\",[\"$\",\"$Lf\",null,{\"promise\":\"$@10\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"s_8oDB3oCVzKAU2R8l0zm\",{\"children\":[[\"$\",\"$L11\",null,{\"children\":\"$L12\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$13\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"14:\"$Sreact.suspense\"\n15:I[74911,[],\"AsyncMetadata\"]\nb:[\"$\",\"$14\",null,{\"fallback\":null,\"children\":[\"$\",\"$L15\",null,{\"promise\":\"$@16\"}]}]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션\\\",\\\"description\\\":\\\"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.\\\",\\\"image\\\":[\\\"https://leeduhan.github.io/og-image.jpg\\\"],\\\"author\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"zeke\\\"},\\\"publisher\\\":{\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Blog\\\",\\\"logo\\\":{\\\"@type\\\":\\\"ImageObject\\\",\\\"url\\\":\\\"https://leeduhan.github.io/logo.png\\\"}},\\\"url\\\":\\\"https://leeduhan.github.io/posts/react/2025-08-19-html2canvas_cors_guide\\\",\\\"datePublished\\\":\\\"2025-08-19\\\",\\\"dateModified\\\":\\\"2025-08-19\\\",\\\"keywords\\\":\\\"Next.js, html2canvas, CORS, React, TypeScript, 이미지 프록시\\\",\\\"articleSection\\\":\\\"Technology\\\",\\\"inLanguage\\\":\\\"ko-KR\\\"}\"}}],[\"$\",\"div\",null,{\"className\":\"max-w-3xl mx-auto space-y-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"pt-4\",\"children\":[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-arrow-left h-4 w-4\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1l729n\",{\"d\":\"m12 19-7-7 7-7\"}],[\"$\",\"path\",\"x3x0zl\",{\"d\":\"M19 12H5\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":\"홈으로 돌아가기\"}]]}]}],[\"$\",\"article\",null,{\"className\":\"space-y-8\",\"children\":[[\"$\",\"header\",null,{\"className\":\"space-y-6\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-y-6\",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-5xl font-bold tracking-tight leading-tight\",\"children\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션\"}]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-6 text-sm text-muted-foreground py-4\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2025-08-19\",\"className\":\"flex items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"children\":\"📅\"}],\"2025년 8월 19일\"]}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap items-center gap-2\",\"children\":[[\"$\",\"span\",null,{\"children\":\"🏷️\"}],[[\"$\",\"$L5\",\"Next.js\",{\"href\":\"/tags/nextjs\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"Next.js\"}],[\"$\",\"$L5\",\"html2canvas\",{\"href\":\"/tags/html2canvas\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"html2canvas\"}],[\"$\",\"$L5\",\"CORS\",{\"href\":\"/tags/cors\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"CORS\"}],[\"$\",\"$L5\",\"React\",{\"href\":\"/tags/react\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"React\"}],[\"$\",\"$L5\",\"TypeScript\",{\"href\":\"/tags/typescript\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"TypeScript\"}],[\"$\",\"$L5\",\"이미지 프록시\",{\"href\":\"/tags/image-proxy\",\"className\":\"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-accent text-accent-foreground hover:bg-primary hover:text-primary-foreground transition-colors\",\"children\":\"이미지 프록시\"}]]]}]]}],[\"$\",\"div\",null,{\"className\":\"bg-accent/50 rounded-lg p-6 border-l-4 border-primary\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-lg leading-relaxed italic text-muted-foreground\",\"children\":\"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.\"}]}]]}],[\"$\",\"div\",null,{\"className\":\"notion-content\",\"children\":\"$L17\"}]]}]]}]]\n"])</script><script>self.__next_f.push([1,"e:null\n"])</script><script>self.__next_f.push([1,"18:I[18199,[\"6249\",\"static/chunks/cb15b0f3-4f54b17909709afc.js\",\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9522\",\"static/chunks/9522-efe1b27bdbdfccd2.js\",\"6156\",\"static/chunks/app/posts/%5B...slug%5D/page-533962adf6041fb8.js\"],\"CodeBlock\"]\n19:I[91349,[\"6249\",\"static/chunks/cb15b0f3-4f54b17909709afc.js\",\"6874\",\"static/chunks/6874-fa507aafc07af06a.js\",\"9522\",\"static/chunks/9522-efe1b27bdbdfccd2.js\",\"6156\",\"static/chunks/app/posts/%5B...slug%5D/page-533962adf6041fb8.js\"],\"Mermaid\"]\n"])</script><script>self.__next_f.push([1,"17:[[\"$\",\"h1\",null,{\"id\":\"nextjs-15에서-html2canvas-cors-에러-해결하기-이미지-프록시-솔루션\",\"children\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"html2canvas를 사용해 화면 캡처 기능을 구현하다 보면 외부 CDN 이미지로 인한 CORS 에러를 자주 만나게 됩니다. 이 글에서는 여러 해결 방법을 비교 분석하고, 실제로 성공한 Next.js API Route 프록시 솔루션을 상세히 공유합니다.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"-목차\",\"children\":\"📋 목차\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9%EA%B3%BC-%EC%9B%90%EC%9D%B8\",\"children\":\"문제 상황과 원인\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95-%EB%B9%84%EA%B5%90\",\"children\":\"해결 방법 비교\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%8B%A4%EC%A0%9C-%EC%84%B1%EA%B3%B5%ED%95%9C-%ED%95%B4%EA%B2%B0%EC%B1%85-nextjs-%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%94%84%EB%A1%9D%EC%8B%9C\",\"children\":\"실제 성공한 해결책: Next.js 이미지 프록시\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EB%8C%80%EC%95%88-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95%EB%93%A4\",\"children\":\"대안 해결 방법들\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%B0%8F-%EC%B6%94%EA%B0%80-%ED%8C%81\",\"children\":\"성능 최적화 및 추가 팁\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"문제-상황과-원인\",\"children\":\"문제 상황과 원인\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"웹 애플리케이션에서 html2canvas를 사용해 화면을 캡처하려고 했는데 다음과 같은 CORS 에러가 발생했습니다:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"code-highlight\",\"data-language\":\"\",\"children\":[\"$\",\"code\",null,{\"className\":\"code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":\"Access to image at 'https://cdn.example.com/images/my-image.svg' \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":\"from origin 'http://localhost:3001' has been blocked by CORS policy: \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":\"No 'Access-Control-Allow-Origin' header is present on the requested resource.\\n\"}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"근본-원인\",\"children\":\"근본 원인\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"html2canvas의 작동 방식\"}],\": DOM을 Canvas로 그리는 과정에서 Canvas API를 사용\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Same-Origin Policy\"}],\": 브라우저의 보안 정책으로 인한 크로스 도메인 이미지 접근 제한\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"외부 CDN 이미지\"}],\": CORS 헤더를 제공하지 않는 외부 도메인 이미지\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"브라우저 캐싱\"}],\": 첫 번째 요청 시 CORS 헤더가 없으면 캐시된 이미지도 동일한 문제 발생\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"해결-방법-비교\",\"children\":\"해결 방법 비교\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"여러 해결 방법을 시도해본 결과, 각각의 장단점을 정리하면 다음과 같습니다:\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"순위\"}],[\"$\",\"th\",null,{\"children\":\"방법\"}],[\"$\",\"th\",null,{\"children\":\"난이도\"}],[\"$\",\"th\",null,{\"children\":\"효과\"}],[\"$\",\"th\",null,{\"children\":\"적용 범위\"}],[\"$\",\"th\",null,{\"children\":\"권장도\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"🏆\"}],[\"$\",\"td\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Next.js API Route 프록시\"}]}],[\"$\",\"td\",null,{\"children\":\"⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"프로덕션\"}],[\"$\",\"td\",null,{\"children\":[\"✅ \",[\"$\",\"strong\",null,{\"children\":\"최고\"}]]}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"🥈\"}],[\"$\",\"td\",null,{\"children\":\"Next.js Image + 커스텀 로더\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"고급\"}],[\"$\",\"td\",null,{\"children\":\"✅ 권장\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"🥉\"}],[\"$\",\"td\",null,{\"children\":\"next.config.js Rewrites\"}],[\"$\",\"td\",null,{\"children\":\"⭐\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"간편\"}],[\"$\",\"td\",null,{\"children\":\"⚠️ 제한적\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"4\"}],[\"$\",\"td\",null,{\"children\":\"클라이언트 최적화\"}],[\"$\",\"td\",null,{\"children\":\"⭐\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"즉시\"}],[\"$\",\"td\",null,{\"children\":\"⚠️ 임시방편\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"5\"}],[\"$\",\"td\",null,{\"children\":\"Middleware CORS\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"⭐⭐⭐\"}],[\"$\",\"td\",null,{\"children\":\"전역\"}],[\"$\",\"td\",null,{\"children\":\"❌ 복잡함\"}]]}]]}]]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-클라이언트-최적화-즉시-적용-가능-️\",\"children\":\"1. 클라이언트 최적화 (즉시 적용 가능) ⚠️\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"가장 빠르게 적용할 수 있는 임시 해결책입니다:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" html2canvas \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'html2canvas'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"captureElement\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 이미지들을 캐시 무효화로 미리 로드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" images \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" document\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"querySelectorAll\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'img'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"Promise\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"all\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"Array\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"from\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"images\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"img \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetch\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"img\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"src \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"+\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"?t=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"        cache\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'no-cache'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"        mode\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'cors'\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// html2canvas 실행\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" canvas \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"html2canvas\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"elementRef\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"current\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"    useCORS\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"    allowTaint\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"    scale\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"    logging\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"    foreignObjectRendering\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" canvas\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"toDataURL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'image/png'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"장점\"}],\": 즉시 적용 가능, 별도 서버 설정 불필요\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"단점\"}],\": 브라우저 캐싱 문제로 불안정, 근본적 해결책 아님\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-nextconfigjs-rewrites-간단한-프록시-️\",\"children\":\"2. next.config.js Rewrites (간단한 프록시) ⚠️\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"설정만으로 간단히 해결하는 방법:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-javascript code-highlight\",\"data-language\":\"javascript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-javascript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// next.config.js\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token doc-comment comment\",\"children\":[\"/** \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"@type\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'next'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"NextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}]]}],\" */\"]}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" nextConfig \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"rewrites\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword control-flow\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"source\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'/api/images/:path*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"destination\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https://external-domain.com/:path*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"images\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"remotePatterns\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"protocol\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token literal-property property\",\"children\":\"hostname\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'**'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":[\"module\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token property-access\",\"children\":\"exports\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" nextConfig\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"장점\"}],\": 설정만으로 해결, Next.js 내장 기능 활용\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"단점\"}],\": 특정 도메인에만 제한적, 동적 URL 처리 어려움\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-nextjs-image--커스텀-로더-권장-\",\"children\":\"3. Next.js Image + 커스텀 로더 (권장) ✅\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next.js Image 컴포넌트의 강력한 기능을 활용:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// components/ProxyImage.tsx\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'use client'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" Image \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'next/image'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"customLoader\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" quality \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"  src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  width\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"number\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  quality\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"number\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 외부 도메인 이미지는 프록시를 통해 로드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"startsWith\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'http'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"window\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"location\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"hostname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"/api/proxy-image?url=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"encodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026w=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"width\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026q=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"quality \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"75\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"default\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"ProxyImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"Image\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"      loader\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"customLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":[\"      crossOrigin\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"anonymous\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"26\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"장점\"}],\": 자동 최적화, WebP 변환, 레이지 로딩, 반응형 지원\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"단점\"}],\": Next.js Image API 학습 필요, 약간 복잡함\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"실제-성공한-해결책-nextjs-이미지-프록시\",\"children\":\"실제 성공한 해결책: Next.js 이미지 프록시\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"여러 해결 방법을 시도한 결과, \",[\"$\",\"strong\",null,{\"children\":\"Next.js API Route를 활용한 이미지 프록시\"}],\" 방식이 가장 안정적이고 효과적인 솔루션이었습니다. 이 방법으로 프로덕션 환경에서 완전히 문제를 해결할 수 있었습니다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"핵심-아이디어\",\"children\":\"핵심 아이디어\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"외부 CDN 이미지를 직접 사용하지 않고, Next.js 서버를 경유해서 이미지를 프록시하여 CORS 헤더를 추가하는 방식입니다:\"}],\"\\n\",[\"$\",\"$L19\",null,{\"chart\":\"sequenceDiagram\\n    participant Browser as Browser\\n    participant API as Next.js API Route\\n    participant CDN as External CDN\\n\\n    Browser-\u003e\u003eAPI: Image Request (/api/image-proxy?url=...)\\n    Note over API: Prepare CORS Headers\\n    API-\u003e\u003eCDN: Fetch External Image\\n    CDN--\u003e\u003eAPI: Image Data Response\\n    Note over API: Add CORS Headers\\n    API--\u003e\u003eBrowser: Image + CORS Headers\\n    Note over Browser: html2canvas can use\u003cbr/\u003ewithout CORS issues\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1단계-api-route-프록시-엔드포인트-생성\",\"children\":\"1단계: API Route 프록시 엔드포인트 생성\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"가장 핵심이 되는 서버사이드 프록시 엔드포인트를 구현합니다:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// app/api/image-proxy/route.ts\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" NextRequest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" NextResponse \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'next/server'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GET\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"request\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" NextRequest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" searchParams \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"URL\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"request\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageUrl \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" searchParams\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'url'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" NextResponse\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"json\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'URL parameter is required'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" status\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"400\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 외부 이미지 URL 유효성 검사\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"URL\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"decodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":\"    \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 허용된 도메인만 프록시 (보안상 중요)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" allowedDomains \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'cdn.example.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'assets.mysite.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'images.service.com'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":\"    \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"allowedDomains\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"hostname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" NextResponse\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"json\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Domain not allowed'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" status\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"403\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"26\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"27\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 외부 이미지 fetch\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"28\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" response \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetch\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"decodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"29\",\"children\":[\"      headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"30\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'User-Agent'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Mozilla/5.0 (compatible; NextJS Image Proxy)'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"31\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"32\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"33\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"34\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"response\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"ok\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"35\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" NextResponse\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"json\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"36\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"Failed to fetch image: \"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"response\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"status\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"37\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" status\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" response\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"status \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"38\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"39\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"40\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"41\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageBuffer \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" response\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"arrayBuffer\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"42\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" contentType \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" response\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"headers\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'content-type'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'image/jpeg'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"43\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"44\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 🔑 핵심: CORS 헤더와 함께 이미지 반환\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"45\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"NextResponse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"46\",\"children\":[\"      headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"47\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"48\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Cache-Control'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'public, max-age=31536000, immutable'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"49\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Origin'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"50\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Methods'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'GET'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"51\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Headers'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"52\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"53\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"54\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"catch\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"55\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Image proxy error:'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"56\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" NextResponse\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"json\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Failed to proxy image'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" status\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"500\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"57\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"58\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2단계-proxyimage-컴포넌트-구현\",\"children\":\"2단계: ProxyImage 컴포넌트 구현\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"외부 이미지를 자동으로 프록시를 통해 로드하는 컴포넌트를 만듭니다:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// components/ProxyImage.tsx\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'use client'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" Image\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" ImageLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" ImageProps \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'next/image'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" useState \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'react'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 외부 도메인 이미지인지 확인 (SSR 안전)\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" isExternalImage \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"boolean\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"URL\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'http:'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https:'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"catch\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 🔑 핵심: CORS 문제 해결을 위한 커스텀 로더\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" corsProxyLoader\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"ImageLoader\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" width\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" quality \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 외부 도메인 이미지면 프록시를 통해 로드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"isExternalImage\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"/api/image-proxy?url=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"encodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026w=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"width\",[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\u0026q=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"quality \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"75\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 내부 이미지는 그대로 사용\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"26\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"interface\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"ProxyImageProps\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"extends\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"Omit\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"ImageProps\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'loader'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"27\",\"children\":[\"  fallbackSrc\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"28\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"29\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"30\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"ProxyImage\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" fallbackSrc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" onError\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],\"props \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" ProxyImageProps\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"31\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" setError\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"useState\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"32\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"33\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"handleError\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"e\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" React\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"SyntheticEvent\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"HTMLImageElement\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"34\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"setError\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"35\",\"children\":[\"    onError\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"?.\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"e\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"36\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"37\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"38\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 에러 시 fallback 이미지 표시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"39\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"error \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" fallbackSrc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"40\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"41\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"Image\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"42\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"43\",\"children\":[\"        src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"fallbackSrc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"44\",\"children\":[\"        loader\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"corsProxyLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"45\",\"children\":[\"        crossOrigin\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"anonymous\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"46\",\"children\":[\"        onError\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"handleError\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"47\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"48\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"49\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"50\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"51\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"52\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\"Image\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"53\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"...\"}],\"props\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"54\",\"children\":[\"      loader\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"corsProxyLoader\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"55\",\"children\":[\"      crossOrigin\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"\\\"anonymous\\\"\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"56\",\"children\":[\"      onError\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"handleError\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"57\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"/\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"58\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"59\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3단계-컴포넌트-교체\",\"children\":\"3단계: 컴포넌트 교체\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이제 기존 이미지 컴포넌트를 ProxyImage로 교체하기만 하면 됩니다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"교체 과정\"}],\":\"]}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"기존 \",[\"$\",\"code\",null,{\"children\":\"\u003cImage\u003e\"}],\" 또는 \",[\"$\",\"code\",null,{\"children\":\"\u003cimg\u003e\"}],\" 태그를 \",[\"$\",\"code\",null,{\"children\":\"\u003cProxyImage\u003e\"}],\"로 변경\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"외부 CDN URL을 사용하는 이미지들을 우선적으로 교체\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"필요에 따라 \",[\"$\",\"code\",null,{\"children\":\"fallbackSrc\"}],\" prop으로 대체 이미지 지정\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"기존 props(\",[\"$\",\"code\",null,{\"children\":\"width\"}],\", \",[\"$\",\"code\",null,{\"children\":\"height\"}],\", \",[\"$\",\"code\",null,{\"children\":\"className\"}],\" 등)은 그대로 유지 가능\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"핵심 포인트\"}],\": ProxyImage는 Next.js Image와 동일한 API를 제공하므로, 기존 코드의 변경 없이도 CORS 문제를 해결할 수 있습니다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"4단계-html2canvas와-함께-사용\",\"children\":\"4단계: html2canvas와 함께 사용\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"html2canvas로 캡처할 때 ProxyImage가 포함된 컴포넌트를 캡처하면 CORS 문제 없이 정상 작동합니다:\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" html2canvas \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'html2canvas'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"handleCapture\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" element \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" document\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"querySelector\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'[data-capture-target]'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"as\"}],\" HTMLElement\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":\"  \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"element\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" canvas \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"html2canvas\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"element\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"      useCORS\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"      allowTaint\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"      scale\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"      backgroundColor\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'#ffffff'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 이미지 다운로드\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" link \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" document\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"createElement\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'a'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"    link\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"download \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"capture-\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],\"Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\".png\"}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"    link\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"href \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" canvas\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"toDataURL\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'image/png'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"    link\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"click\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"catch\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"error\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'캡처 실패:'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"핵심-구현-포인트\",\"children\":\"핵심 구현 포인트\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-보안-고려사항\",\"children\":\"1. 보안 고려사항\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 허용된 도메인만 프록시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" allowedDomains \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'cdn.example.com'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'assets.mysite.com'\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"!\"}],\"allowedDomains\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"includes\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"hostname\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" NextResponse\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"json\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" error\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Domain not allowed'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" status\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"403\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"허용된 도메인만 프록시하여 보안 위험을 방지합니다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-ssr-호환성\",\"children\":\"2. SSR 호환성\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" isExternalImage \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"boolean\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"try\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"URL\"}]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"src\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// window.location이 아닌 프로토콜로 판단하여 SSR 안전성 확보\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'http:'\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"||\"}],\" url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"protocol \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"===\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'https:'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"catch\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"서버사이드 렌더링에서도 안전하게 작동하도록 \",[\"$\",\"code\",null,{\"children\":\"window\"}],\" 객체 의존성을 제거했습니다.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-캐시-최적화\",\"children\":\"3. 캐시 최적화\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[\"headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Cache-Control'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'public, max-age=31536000, immutable'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Origin'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Methods'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'GET'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Headers'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이미지를 1년간 캐시하여 성능을 최적화합니다.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"트러블슈팅\",\"children\":\"트러블슈팅\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-hydration-mismatch-에러\",\"children\":\"1. Hydration Mismatch 에러\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"문제\"}],\": 서버와 클라이언트에서 다른 URL 생성으로 인한 Hydration 에러\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"해결\"}],\": \",[\"$\",\"code\",null,{\"children\":\"window.location.origin\"}],\" 대신 프로토콜 기반으로 외부 이미지 판단\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-무한-로딩\",\"children\":\"2. 무한 로딩\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"문제\"}],\": 프록시 로더가 적용되지 않아 원본 URL로 요청\",[\"$\",\"br\",null,{}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"해결\"}],\": SSR 안전한 로직으로 변경하여 서버/클라이언트 일관성 확보\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"대안-해결-방법들\",\"children\":\"대안 해결 방법들\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-캐싱이-포함된-개선된-api-route\",\"children\":\"1. 캐싱이 포함된 개선된 API Route\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 메모리 캐시 추가\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageCache \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"Map\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" ArrayBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  contentType\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  timestamp\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"number\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"CACHE_DURATION\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 10분 캐시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GET\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"request\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" NextRequest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 캐시 확인 로직 추가\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" cached \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" imageCache\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cached \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"timestamp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"CACHE_DURATION\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"NextResponse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[\"      headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Origin'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Cache-Control'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'public, max-age=300'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":\"  \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch 후 캐시에 저장\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[\"  imageCache\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"set\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imageBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"26\",\"children\":[\"    contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"27\",\"children\":[\"    timestamp\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"28\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"29\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-대안-라이브러리-고려\",\"children\":\"2. 대안 라이브러리 고려\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-bash code-highlight\",\"data-language\":\"bash\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash code-highlight\",\"children\":[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"npm\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"install\"}],\" modern-screenshot\\n\"]}]}]}]}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"import\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" domToJpeg \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"from\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'modern-screenshot'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" dataUrl \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"domToJpeg\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"element\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"성능-최적화-및-추가-팁\",\"children\":\"성능 최적화 및 추가 팁\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-html2canvas-최적화-설정\",\"children\":\"1. html2canvas 최적화 설정\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" canvas \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"html2canvas\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"element\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"  useCORS\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  allowTaint\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  scale\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  logging\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  backgroundColor\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'#ffffff'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"  foreignObjectRendering\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  imageTimeout\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"onclone\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"clonedDoc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'문서 클론 완료'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-이미지-프리로딩\",\"children\":\"2. 이미지 프리로딩\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 캡처 전 이미지 프리로딩\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"preloadImages\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"urls\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"Promise\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"all\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"    urls\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetch\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"/api/image-proxy?url=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"encodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"        cache\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'no-cache'\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"결과\",\"children\":\"결과\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"✅ \",[\"$\",\"strong\",null,{\"children\":\"CORS 에러 해결\"}],\": 외부 CDN 이미지를 프록시를 통해 안전하게 로드\",[\"$\",\"br\",null,{}],\"\\n\",\"✅ \",[\"$\",\"strong\",null,{\"children\":\"html2canvas 호환\"}],\": 캡처 기능이 정상적으로 작동\",[\"$\",\"br\",null,{}],\"\\n\",\"✅ \",[\"$\",\"strong\",null,{\"children\":\"성능 최적화\"}],\": 이미지 캐싱 및 반응형 최적화\",[\"$\",\"br\",null,{}],\"\\n\",\"✅ \",[\"$\",\"strong\",null,{\"children\":\"보안 강화\"}],\": 허용된 도메인만 프록시하여 보안 위험 방지\",[\"$\",\"br\",null,{}],\"\\n\",\"✅ \",[\"$\",\"strong\",null,{\"children\":\"개발자 경험\"}],\": 기존 Image 컴포넌트와 동일한 API로 쉬운 사용\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"마무리\",\"children\":\"마무리\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next.js의 API Route를 활용한 이미지 프록시 솔루션으로 CORS 문제를 깔끔하게 해결할 수 있었습니다. 특히 SSR 호환성과 보안을 고려한 설계로 프로덕션 환경에서도 안전하게 사용할 수 있는 솔루션이 되었습니다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"권장-구현-순서\",\"children\":\"권장 구현 순서\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"1단계\"}],\": API Route 프록시 엔드포인트 생성 (10분)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"2단계\"}],\": ProxyImage 컴포넌트 구현 (20분)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"3단계\"}],\": 기존 이미지 컴포넌트 교체 (5분)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"4단계\"}],\": html2canvas 테스트 및 최적화 (15분)\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"5단계\"}],\": 성능 최적화 및 캐싱 추가 (선택사항)\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"이 순서대로 진행하면 \",[\"$\",\"strong\",null,{\"children\":\"Next.js 15의 강력한 서버사이드 기능을 활용\"}],\"하여 html2canvas CORS 문제를 \",[\"$\",\"strong\",null,{\"children\":\"가장 효율적으로 해결\"}],\"할 수 있습니다!\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"핵심-성과\",\"children\":\"핵심 성과\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"html2canvas 호환성\"}],\": 외부 CDN 이미지가 포함된 화면을 성공적으로 캡처\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"성능 최적화\"}],\": 이미지 캐싱과 반응형 최적화로 사용자 경험 향상\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"보안 강화\"}],\": 도메인 화이트리스트로 악의적 요청 차단\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"개발자 경험\"}],\": 기존 Image 컴포넌트와 동일한 API로 쉬운 마이그레이션\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이 방법은 html2canvas뿐만 아니라 Canvas API를 사용하는 다른 라이브러리(Fabric.js, Konva.js 등)에서도 동일하게 적용할 수 있어, 크로스 도메인 이미지 처리가 필요한 다양한 상황에서 유용할 것입니다.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"️-api-route-프록시-방식-주의사항\",\"children\":\"⚠️ API Route 프록시 방식 주의사항\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"API Route 프록시는 html2canvas CORS 문제를 해결하지만, \",[\"$\",\"strong\",null,{\"children\":\"서버 리소스\"}],\" 측면에서 고려해야 할 사항이 있습니다:\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"️-서버-리소스-문제\",\"children\":\"🖼️ 서버 리소스 문제\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-html code-highlight\",\"data-language\":\"html\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-html code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"\u003c!-- Next.js Image가 생성하는 HTML --\u003e\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\u003c\"}],\"img\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"token attr-name\",\"children\":\"srcset\"}],[\"$\",\"span\",null,{\"className\":\"token attr-value\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation attr-equals\",\"children\":\"=\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\"\"}],\"/api/image-proxy?url=...\u0026w=256 256w,\\n\"]}]]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[\"$\",\"span\",null,{\"className\":\"token attr-value\",\"children\":\"             /api/image-proxy?url=...\u0026w=384 384w,\\n\"}]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token tag\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token attr-value\",\"children\":[\"             /api/image-proxy?url=...\u0026w=640 640w\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"\\\"\"}]]}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"/\u003e\"}]]}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"문제점\"}],\":\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"모든 이미지 요청이 서버를 거쳐감 → \",[\"$\",\"strong\",null,{\"children\":\"서버 부하 증가\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"여러 크기의 이미지가 서버 캐시에 저장 → \",[\"$\",\"strong\",null,{\"children\":\"메모리 사용량 증가\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Vercel/Netlify 등에서 \",[\"$\",\"strong\",null,{\"children\":\"Function timeout\"}],\" 발생 가능\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"-해결-방법\",\"children\":\"💡 해결 방법\"}],\"\\n\",[\"$\",\"h4\",null,{\"id\":\"1-적극적인-캐시-정책\",\"children\":\"1. 적극적인 캐시 정책\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"NextResponse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"  headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Cache-Control'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'public, max-age=31536000, immutable'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Origin'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"id\":\"2-cdn-활용\",\"children\":\"2. CDN 활용\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"CloudFlare, AWS CloudFront로 서버 부하 분산\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"이미지 크기 제한 (최대 5MB)\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"화이트리스트 도메인 관리\"}],\"\\n\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"📝 Next.js Image 컴포넌트 기술적 제한사항\"}],\": \",[\"$\",\"code\",null,{\"children\":\"unoptimized\"}],\"와 \",[\"$\",\"code\",null,{\"children\":\"loader\"}],\" 충돌 문제, SVG 처리 방법 등은 \",[\"$\",\"a\",null,{\"href\":\"./2025-08-19-nextjs-15-image-optimization-guide\",\"children\":\"다음 글\"}],\"에서 상세히 다룹니다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"-성능-최적화-및-추가-팁\",\"children\":\"🚀 성능 최적화 및 추가 팁\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"1-html2canvas-최적화-설정-1\",\"children\":\"1. html2canvas 최적화 설정\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" canvas \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"html2canvas\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"element\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[\"  useCORS\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  allowTaint\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"  scale\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"2\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"  logging\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"false\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"  backgroundColor\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'#ffffff'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"  foreignObjectRendering\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token boolean\",\"children\":\"true\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"  imageTimeout\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10000\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"onclone\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"clonedDoc\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"console\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"log\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'문서 클론 완료'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"2-이미지-프리로딩-1\",\"children\":\"2. 이미지 프리로딩\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 캡처 전 이미지 프리로딩\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token function-variable function\",\"children\":\"preloadImages\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"urls\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"[\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"]\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"await\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"Promise\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"all\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"    urls\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"map\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\u003e\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"fetch\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token template-string\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}],[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"/api/image-proxy?url=\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"$${\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"encodeURIComponent\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"url\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token interpolation-punctuation punctuation\",\"children\":\"}\"}]]}],[\"$\",\"span\",null,{\"className\":\"token template-punctuation string\",\"children\":\"`\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[\"        cache\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'no-cache'\"}],\" \\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"3-메모리-캐시-추가-고급\",\"children\":\"3. 메모리 캐시 추가 (고급)\"}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"code-block-wrapper my-6\",\"children\":[\"$\",\"$L18\",null,{\"className\":\"language-typescript code-highlight\",\"data-language\":\"typescript\",\"children\":[\"$\",\"code\",null,{\"className\":\"language-typescript code-highlight\",\"children\":[[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"1\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 메모리 캐시 추가\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" imageCache \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"Map\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}]]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"3\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" ArrayBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"4\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  contentType\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"string\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"5\",\"children\":[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[\"  timestamp\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token builtin\",\"children\":\"number\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"6\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003e\"}]]}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"7\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"8\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"CACHE_DURATION\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"1000\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"60\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"*\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token number\",\"children\":\"10\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 10분 캐시\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"9\",\"children\":\"\\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"10\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"export\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"async\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"GET\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"request\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" NextRequest\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"11\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// 캐시 확인 로직 추가\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"12\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"const\"}],\" cached \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"=\"}],\" imageCache\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"get\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"13\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"if\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cached \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u0026\u0026\"}],\" Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"-\"}],\" cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"timestamp \",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\"\u003c\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token constant\",\"children\":\"CACHE_DURATION\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"14\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"return\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token keyword\",\"children\":\"new\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token class-name\",\"children\":\"NextResponse\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"data\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"15\",\"children\":[\"      headers\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"16\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Content-Type'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" cached\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],\"contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"17\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Access-Control-Allow-Origin'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'*'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"18\",\"children\":[\"        \",[\"$\",\"span\",null,{\"className\":\"token string-property property\",\"children\":\"'Cache-Control'\"}],[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token string\",\"children\":\"'public, max-age=300'\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"19\",\"children\":[\"      \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"20\",\"children\":[\"    \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"21\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"22\",\"children\":\"  \\n\"}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"23\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token comment\",\"children\":\"// fetch 후 캐시에 저장\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"24\",\"children\":[\"  imageCache\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"set\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],\"imageUrl\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\" \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"{\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"25\",\"children\":[\"    data\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" imageBuffer\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"26\",\"children\":[\"    contentType\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"27\",\"children\":[\"    timestamp\",[\"$\",\"span\",null,{\"className\":\"token operator\",\"children\":\":\"}],\" Date\",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\".\"}],[\"$\",\"span\",null,{\"className\":\"token function\",\"children\":\"now\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"(\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\",\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"28\",\"children\":[\"  \",[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\")\"}],[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\";\"}],\"\\n\"]}],[\"$\",\"span\",null,{\"className\":\"code-line line-number\",\"line\":\"29\",\"children\":[[\"$\",\"span\",null,{\"className\":\"token punctuation\",\"children\":\"}\"}],\"\\n\"]}]]}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"-더-자세한-이미지-최적화-가이드\",\"children\":\"📚 더 자세한 이미지 최적화 가이드\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Next.js 15의 공식 권장사항과 더 자세한 성능 비교를 원한다면 **\",[\"$\",\"a\",null,{\"href\":\"/posts/react/2025-08-19-nextjs-15-image-optimization-guide\",\"children\":\"Next.js 15 이미지 최적화 완전 가이드\"}],\"**를 참고하세요.\"]}]]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nd:null\n"])</script><script>self.__next_f.push([1,"16:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.\"}],[\"$\",\"meta\",\"2\",{\"name\":\"author\",\"content\":\"zeke\"}],[\"$\",\"meta\",\"3\",{\"name\":\"keywords\",\"content\":\"Next.js, html2canvas, CORS, React, TypeScript, 이미지 프록시\"}],[\"$\",\"meta\",\"4\",{\"name\":\"creator\",\"content\":\"zeke\"}],[\"$\",\"meta\",\"5\",{\"name\":\"publisher\",\"content\":\"Blog\"}],[\"$\",\"meta\",\"6\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"7\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"8\",{\"name\":\"google-site-verification\",\"content\":\"wjBK5vsP3u8w2Mb0BHXkojvPGQ56soPTBYg2fU5dg5k\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:title\",\"content\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:description\",\"content\":\"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:url\",\"content\":\"https://leeduhan.github.io/posts/react/2025-08-19-html2canvas_cors_guide\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:site_name\",\"content\":\"Blog\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image\",\"content\":\"https://leeduhan.github.io/og-image.jpg\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image:width\",\"content\":\"1200\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:image:height\",\"content\":\"630\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:image:alt\",\"content\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션\"}],[\"$\",\"meta\",\"17\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"18\",{\"property\":\"article:published_time\",\"content\":\"2025-08-19\"}],[\"$\",\"meta\",\"19\",{\"property\":\"article:author\",\"content\":\"zeke\"}],[\"$\",\"meta\",\"20\",{\"property\":\"article:tag\",\"content\":\"Next.js\"}],[\"$\",\"meta\",\"21\",{\"property\":\"article:tag\",\"content\":\"html2canvas\"}],[\"$\",\"meta\",\"22\",{\"property\":\"article:tag\",\"content\":\"CORS\"}],[\"$\",\"meta\",\"23\",{\"property\":\"article:tag\",\"content\":\"React\"}],[\"$\",\"meta\",\"24\",{\"property\":\"article:tag\",\"content\":\"TypeScript\"}],[\"$\",\"meta\",\"25\",{\"property\":\"article:tag\",\"content\":\"이미지 프록시\"}],[\"$\",\"meta\",\"26\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"27\",{\"name\":\"twitter:creator\",\"content\":\"@zeke\"}],[\"$\",\"meta\",\"28\",{\"name\":\"twitter:title\",\"content\":\"Next.js 15에서 html2canvas CORS 에러 해결하기: 이미지 프록시 솔루션 | Blog\"}],[\"$\",\"meta\",\"29\",{\"name\":\"twitter:description\",\"content\":\"html2canvas 사용 시 외부 CDN 이미지로 인한 CORS 에러를 Next.js API Route 프록시로 완벽 해결한 과정과 다양한 해결 방법들을 상세히 소개합니다.\"}],[\"$\",\"meta\",\"30\",{\"name\":\"twitter:image\",\"content\":\"https://leeduhan.github.io/og-image.jpg\"}],[\"$\",\"link\",\"31\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"10:{\"metadata\":\"$16:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>